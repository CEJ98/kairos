# üìä Sistema de M√©tricas Corporales Kairos - Gu√≠a Completa

Sistema completo de registro y visualizaci√≥n de m√©tricas corporales con gr√°ficos Recharts, validaci√≥n de inputs, y comparador de fotos de progreso.

---

## üéØ Caracter√≠sticas Implementadas

### ‚úÖ **Registro de Peso**
- Peso corporal (kg) - campo requerido
- Grasa corporal (%) - opcional
- Masa muscular (kg) - opcional
- Selector de fecha
- Validaci√≥n con Zod (min/max valores)

### ‚úÖ **Gr√°fico de Peso con Recharts**
- LineChart con 3 l√≠neas: peso, grasa, masa muscular
- Gradientes fill bajo las l√≠neas
- Eje X: fechas formateadas en espa√±ol
- Eje Y: escala autom√°tica con padding
- Tooltip personalizado con valores formateados
- Indicadores de tendencia (‚Üë ‚Üì ‚Äî)
- Cards de resumen: peso inicial, actual, cambio de grasa
- C√°lculo de % de cambio

### ‚úÖ **Registro de Medidas Corporales**
- 8 mediciones: pecho, cintura, cadera, hombros, brazos (L/R), muslos (L/R)
- Todas opcionales (permite medir solo las que se deseen)
- Validaci√≥n de rangos (cm)
- Selector de fecha

### ‚úÖ **Radar Chart de Medidas**
- Gr√°fico radar (spider chart) con Recharts
- Visualizaci√≥n de medidas actuales vs anteriores
- Gradiente radial purple
- Lista de medidas con valores y cambios
- Card de resumen de cambios desde √∫ltimo registro
- Colores diferenciados: verde (reducci√≥n), naranja (aumento)

### ‚úÖ **Sistema de Fotos de Progreso**
- Upload de im√°genes con preview
- Validaci√≥n: m√°x 5MB, solo im√°genes
- Almacenamiento de data URL (demo) - listo para Supabase Storage
- Notas opcionales por foto
- Galer√≠a con grid responsive
- Modo comparaci√≥n: selecciona 2 fotos side-by-side
- Full screen view con dialog
- Eliminaci√≥n de fotos con confirmaci√≥n

### ‚úÖ **Dashboard Completo**
- Hero section con gradiente
- 4 summary cards: peso, grasa, mediciones, fotos
- Quick actions buttons
- Layout responsive con animaciones Framer Motion
- Loading skeletons
- Toast notifications (sonner)

### ‚úÖ **Forms Avanzados**
- Tabs: Peso | Medidas | Foto
- react-hook-form + Zod validation
- Error messages inline
- Loading states
- Auto-refresh despu√©s de guardar

---

## üìÅ Estructura de Archivos

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ actions/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ metrics-actions.ts           # Server Actions (Prisma + Zod)
‚îÇ   ‚îî‚îÄ‚îÄ metrics/
‚îÇ       ‚îî‚îÄ‚îÄ page.tsx                      # Dashboard principal
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ metrics/
‚îÇ       ‚îú‚îÄ‚îÄ weight-chart.tsx              # Gr√°fico LineChart de peso
‚îÇ       ‚îú‚îÄ‚îÄ measurements-radar.tsx        # Radar chart de medidas
‚îÇ       ‚îú‚îÄ‚îÄ photo-comparison.tsx          # Galer√≠a y comparador
‚îÇ       ‚îî‚îÄ‚îÄ metrics-forms.tsx             # Forms con tabs

Documentaci√≥n:
‚îî‚îÄ‚îÄ METRICS_GUIDE.md                      # Este archivo
```

---

## üöÄ Server Actions

### Archivo: `src/app/actions/metrics-actions.ts`

#### Schemas de Validaci√≥n

```typescript
const bodyWeightSchema = z.object({
  weight: z.number().min(30).max(300),
  bodyFat: z.number().min(3).max(60).optional(),
  muscleMass: z.number().min(10).max(200).optional(),
  date: z.string().optional(),
});

const bodyMeasurementsSchema = z.object({
  chest: z.number().min(50).max(200).optional(),
  waist: z.number().min(40).max(200).optional(),
  hips: z.number().min(50).max(200).optional(),
  leftArm: z.number().min(15).max(80).optional(),
  rightArm: z.number().min(15).max(80).optional(),
  leftThigh: z.number().min(30).max(120).optional(),
  rightThigh: z.number().min(30).max(120).optional(),
  shoulders: z.number().min(70).max(200).optional(),
  date: z.string().optional(),
});
```

---

#### `saveBodyWeight(data: BodyWeightInput)`

Guarda entrada de peso corporal:

```typescript
export async function saveBodyWeight(
  data: BodyWeightInput
): Promise<{ success: boolean; error?: string; data?: BodyWeightData }>
```

**Validaciones**:
- ‚úÖ Usuario autenticado
- ‚úÖ Peso entre 30-300 kg
- ‚úÖ Grasa corporal 3-60% (opcional)
- ‚úÖ Masa muscular 10-200 kg (opcional)
- ‚úÖ Fecha v√°lida o usa fecha actual

**Prisma Query**:
```typescript
await prisma.bodyMetric.create({
  data: {
    userId,
    date: recordDate,
    weight: validated.weight,
    bodyFat: validated.bodyFat ?? null,
    muscleMass: validated.muscleMass ?? null,
  },
});
```

**Revalida**: `/metrics`, `/progress-new`

---

#### `saveBodyMeasurements(data: BodyMeasurementsInput)`

Guarda medidas corporales:

```typescript
export async function saveBodyMeasurements(
  data: BodyMeasurementsInput
): Promise<{ success: boolean; error?: string; data?: BodyMeasurementsData }>
```

**Caracter√≠sticas**:
- Todas las medidas opcionales
- Crea registro en `bodyMetric` con medidas en cm
- Validaci√≥n de rangos por parte del cuerpo

---

#### `getBodyWeightHistory(months: number = 6)`

Obtiene historial de peso:

```typescript
export async function getBodyWeightHistory(
  months: number = 6
): Promise<BodyWeightData[]>
```

**Query**:
- √öltimos N meses desde hoy
- Solo registros con `weight !== null`
- Ordenados por fecha ASC
- Retorna: id, date, weight, bodyFat, muscleMass

---

#### `getLatestMeasurements()`

Obtiene √∫ltimas medidas para radar chart:

```typescript
export async function getLatestMeasurements(): Promise<BodyMeasurementsData | null>
```

**Query**:
- √öltimo registro con cualquier medida no-null
- `OR` query en Prisma para 8 campos
- Ordenado por fecha DESC

---

#### `getProgressPhotos()`

Obtiene fotos de progreso:

```typescript
export async function getProgressPhotos(): Promise<ProgressPhotoData[]>
```

**Retorna**:
- Array de fotos ordenadas por `createdAt DESC`
- Campos: id, url, createdAt, notes

---

#### `saveProgressPhoto(url: string, notes?: string)`

Guarda URL de foto (despu√©s de upload):

```typescript
export async function saveProgressPhoto(
  url: string,
  notes?: string
): Promise<{ success: boolean; error?: string; data?: ProgressPhotoData }>
```

**Nota**: En producci√≥n, primero subir a Supabase Storage y pasar URL resultante.

---

#### `deleteProgressPhoto(photoId: string)`

Elimina foto de progreso:

```typescript
export async function deleteProgressPhoto(
  photoId: string
): Promise<{ success: boolean; error?: string }>
```

**Validaciones**:
- Verifica ownership (userId)
- Elimina de BD
- En producci√≥n: tambi√©n eliminar de storage

---

#### `getMetricsSummary()`

Obtiene resumen de m√©tricas para cards:

```typescript
export async function getMetricsSummary(): Promise<MetricsSummary | null>
```

**Calcula**:
- Peso actual
- Cambio de peso (√∫ltimos 30 d√≠as)
- Grasa corporal actual
- Cambio de grasa corporal
- Total de mediciones registradas
- Total de fotos

---

## üìä Componentes

### 1. WeightChart

**Archivo**: [src/components/metrics/weight-chart.tsx](src/components/metrics/weight-chart.tsx:1)

**Props**:
```typescript
interface WeightChartProps {
  data: BodyWeightData[];
}
```

**Caracter√≠sticas**:
- LineChart de Recharts (300px height)
- 3 l√≠neas: peso (s√≥lida), grasa (dashed), masa muscular (dashed)
- Colores: azul (#3B82F6), √°mbar (#F59E0B), verde (#10B981)
- Gradientes bajo las l√≠neas
- Tooltip personalizado con unidades (kg, %)
- Legend con labels en espa√±ol
- Header con peso actual + trend icon
- C√°lculo de cambio de peso y %
- 3 summary cards: peso inicial, actual, cambio grasa

**Empty State**:
```typescript
if (data.length === 0) {
  return <Card>No hay datos...</Card>;
}
```

**Trend Calculation**:
```typescript
const firstWeight = data[0].weight;
const lastWeight = data[data.length - 1].weight;
const weightChange = lastWeight - firstWeight;

let trend: 'up' | 'down' | 'stable' = 'stable';
if (Math.abs(weightChange) > 0.5) {
  trend = weightChange > 0 ? 'up' : 'down';
}
```

**Uso**:
```tsx
<WeightChart data={weightHistory} />
```

---

### 2. MeasurementsRadar

**Archivo**: [src/components/metrics/measurements-radar.tsx](src/components/metrics/measurements-radar.tsx:1)

**Props**:
```typescript
interface MeasurementsRadarProps {
  data: BodyMeasurementsData | null;
  previousData?: BodyMeasurementsData | null;
}
```

**Caracter√≠sticas**:
- RadarChart de Recharts (400px height)
- 8 mediciones posibles (filtra nulls)
- Compara actual vs anterior (si se pasa previousData)
- Gradiente radial purple (#8B5CF6)
- PolarAngleAxis con labels de medidas
- L√≠nea anterior en gris dashed
- L√≠nea actual en purple s√≥lido
- Lista de medidas con valores y cambios
- Card de resumen de cambios por medida

**Empty State**:
```typescript
if (!data) {
  return (
    <Card>
      <Ruler icon />
      <p>Registra tus medidas...</p>
    </Card>
  );
}
```

**Data Preparation**:
```typescript
const measurements = [
  { name: 'Pecho', key: 'chest', current: data.chest, previous: previousData?.chest },
  { name: 'Cintura', key: 'waist', current: data.waist, previous: previousData?.waist },
  // ... 8 medidas
].filter((m) => m.current !== null);

const radarData = measurements.map((m) => ({
  measurement: m.name,
  actual: m.current,
  anterior: m.previous,
}));
```

**Uso**:
```tsx
<MeasurementsRadar data={latestMeasurements} />
```

---

### 3. PhotoComparison

**Archivo**: [src/components/metrics/photo-comparison.tsx](src/components/metrics/photo-comparison.tsx:1)

**Props**:
```typescript
interface PhotoComparisonProps {
  photos: ProgressPhotoData[];
  onUploadClick: () => void;
}
```

**Caracter√≠sticas**:
- 2 modos: Gallery y Compare
- Gallery: grid 2x4 con fotos en aspect-ratio 3:4
- Compare: 2 slots (antes/despu√©s) + selector grid
- Animaciones Framer Motion en cards
- Full screen dialog al click en foto
- Bot√≥n delete con confirmaci√≥n
- Toast feedback para acciones
- Border colors: purple (slot 1), green (slot 2)

**Estados**:
```typescript
const [selectedPhoto, setSelectedPhoto] = useState<ProgressPhotoData | null>(null);
const [compareMode, setCompareMode] = useState(false);
const [comparePhotos, setComparePhotos] = useState<[ProgressPhotoData | null, ProgressPhotoData | null]>([
  null,
  null,
]);
```

**Compare Mode Flow**:
1. Click "Comparar" ‚Üí activa compareMode
2. Muestra 2 slots vac√≠os + grid selector
3. Click en foto del grid ‚Üí asigna a slot 1 o 2
4. Muestra border colored seg√∫n slot
5. Click X en slot ‚Üí limpia selecci√≥n

**Delete Flow**:
```typescript
const handleDeletePhoto = async (photoId: string) => {
  if (!confirm('¬øEst√°s seguro?')) return;

  setIsDeleting(true);
  const result = await deleteProgressPhoto(photoId);

  if (result.success) {
    toast.success('Foto eliminada');
    router.refresh();
  }
  setIsDeleting(false);
};
```

**Uso**:
```tsx
<PhotoComparison
  photos={photos}
  onUploadClick={() => openForms('photo')}
/>
```

---

### 4. MetricsForms

**Archivo**: [src/components/metrics/metrics-forms.tsx](src/components/metrics/metrics-forms.tsx:1)

**Props**:
```typescript
interface MetricsFormsProps {
  isOpen: boolean;
  onClose: () => void;
  initialTab?: 'weight' | 'measurements' | 'photo';
}
```

**Caracter√≠sticas**:
- Dialog de shadcn/ui
- Tabs: Peso | Medidas | Foto
- react-hook-form para Peso y Medidas
- zodResolver para validaci√≥n
- File input para fotos con preview
- Error messages inline
- Loading states por tab
- Auto-refresh al guardar

**Weight Form**:
```typescript
const {
  register: registerWeight,
  handleSubmit: handleSubmitWeight,
  formState: { errors: weightErrors },
  reset: resetWeight,
} = useForm<BodyWeightInput>({
  resolver: zodResolver(weightSchema),
});
```

**Fields**:
- Weight: number input, step 0.1, required
- Body Fat: number input, step 0.1, optional
- Muscle Mass: number input, step 0.1, optional
- Date: date input, defaults to today

**Measurements Form**:
- 8 number inputs (chest, waist, hips, shoulders, arms, thighs)
- Todos opcionales
- Step 0.1
- Labels en espa√±ol

**Photo Upload**:
```typescript
const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
  const file = e.target.files?.[0];

  // Validate size
  if (file.size > 5 * 1024 * 1024) {
    toast.error('M√°ximo 5MB');
    return;
  }

  // Validate type
  if (!file.type.startsWith('image/')) {
    toast.error('Solo im√°genes');
    return;
  }

  setSelectedFile(file);

  // Create preview
  const reader = new FileReader();
  reader.onloadend = () => {
    setPhotoPreview(reader.result as string);
  };
  reader.readAsDataURL(file);
};
```

**Submit**:
```typescript
const handlePhotoUpload = async () => {
  const reader = new FileReader();
  reader.onloadend = async () => {
    const dataUrl = reader.result as string;
    const result = await saveProgressPhoto(dataUrl, photoNotes);

    if (result.success) {
      toast.success('Foto guardada');
      router.refresh();
      onClose();
    }
  };
  reader.readAsDataURL(selectedFile);
};
```

**Uso**:
```tsx
<MetricsForms
  isOpen={isFormsOpen}
  onClose={() => setIsFormsOpen(false)}
  initialTab="weight"
/>
```

---

## üé® P√°gina Principal

### Archivo: [src/app/metrics/page.tsx](src/app/metrics/page.tsx:1)

**Layout**:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Hero Section (Gradiente blue-purple-pink)               ‚îÇ
‚îÇ üìä M√©tricas Corporales + Bot√≥n Registrar               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Summary Cards: Peso | Grasa | Mediciones | Fotos       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Quick Actions: 3 botones (peso, medidas, foto)         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ WeightChart (full width)                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Grid 2 cols: MeasurementsRadar | PhotoComparison       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Tips Section (gradiente purple-pink)                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Estados**:
```typescript
const [isFormsOpen, setIsFormsOpen] = useState(false);
const [formsTab, setFormsTab] = useState<'weight' | 'measurements' | 'photo'>('weight');
const [weightHistory, setWeightHistory] = useState<BodyWeightData[]>([]);
const [latestMeasurements, setLatestMeasurements] = useState<BodyMeasurementsData | null>(null);
const [photos, setPhotos] = useState<ProgressPhotoData[]>([]);
const [summary, setSummary] = useState<MetricsSummary | null>(null);
```

**Data Loading**:
```typescript
const loadData = async () => {
  const [weights, measurements, photosList, summaryData] = await Promise.all([
    getBodyWeightHistory(6),
    getLatestMeasurements(),
    getProgressPhotos(),
    getMetricsSummary(),
  ]);

  setWeightHistory(weights);
  setLatestMeasurements(measurements);
  setPhotos(photosList);
  setSummary(summaryData);
};

useEffect(() => {
  loadData();
}, []);
```

**Summary Cards**:
- 4 cards con gradientes: blue, amber, purple, pink
- Iconos: Scale, Activity, Ruler, Camera
- Trend icons (TrendingUp/Down) si hay cambios
- Valores: peso, grasa%, total mediciones, total fotos
- Texto de cambio: "+X kg este mes"

**Animaciones**:
- Hero: y: -20‚Üí0, duration 0.5s
- Summary: delay 0.1s
- Quick Actions: delay 0.2s
- Weight Chart: delay 0.3s
- Measurements: delay 0.4s
- Photos: delay 0.5s
- Tips: delay 0.6s

**Loading Skeleton**:
```typescript
function LoadingSkeleton() {
  return (
    <div className="space-y-6">
      <Skeleton className="h-40" />
      <div className="grid gap-4 md:grid-cols-4">
        {[...Array(4)].map((_, i) => (
          <Skeleton key={i} className="h-32" />
        ))}
      </div>
      <Skeleton className="h-96" />
      <div className="grid gap-6 lg:grid-cols-2">
        <Skeleton className="h-96" />
        <Skeleton className="h-96" />
      </div>
    </div>
  );
}
```

---

## üé® Estilo Minimalista Kairos

### Paleta de Colores

```typescript
// Gradientes principales
from-blue-50 via-purple-50 to-pink-50   // Hero section
from-blue-500 to-purple-600             // Bot√≥n principal
from-purple-500 to-pink-600             // Tips section

// Summary Cards
from-blue-500 to-blue-600               // Peso
from-amber-500 to-orange-600            // Grasa
from-purple-500 to-purple-600           // Mediciones
from-pink-500 to-rose-600               // Fotos

// Charts
#3B82F6  // Blue - Peso
#F59E0B  // Amber - Grasa corporal
#10B981  // Green - Masa muscular
#8B5CF6  // Purple - Radar chart
```

### Componentes Styled

**Summary Card**:
```css
.card {
  overflow: hidden;
}

.gradient-header {
  background: linear-gradient(to bottom right, from, to);
  padding: 1rem;
  color: white;
}

.stat-value {
  font-size: 1.875rem; /* 3xl */
  font-weight: 700;
  margin-top: 0.25rem;
}
```

**Photo Card (Compare Mode)**:
```css
.compare-slot-1 {
  border: 2px solid #A855F7; /* purple-400 */
  ring: 2px solid #D8B4FE;   /* purple-300 */
}

.compare-slot-2 {
  border: 2px solid #4ADE80; /* green-400 */
  ring: 2px solid #86EFAC;   /* green-300 */
}
```

---

## üß™ Testing

### 1. Registro de Peso

**Pasos**:
1. Click "Registrar" o "Registrar Peso"
2. Tab "Peso" activo
3. Ingresar peso (ej: 75.5)
4. Opcional: grasa (ej: 15.2), masa muscular (ej: 60)
5. Click "Guardar Peso"
6. Ver toast de √©xito
7. Gr√°fico actualiza con nuevo punto

**Validaciones a testear**:
- Peso < 30 ‚Üí error "Peso m√≠nimo: 30kg"
- Peso > 300 ‚Üí error "Peso m√°ximo: 300kg"
- Grasa < 3 o > 60 ‚Üí error
- Submit sin peso ‚Üí error required

---

### 2. Registro de Medidas

**Pasos**:
1. Click "Registrar Medidas"
2. Tab "Medidas" activo
3. Ingresar medidas deseadas (no todas required)
4. Click "Guardar Medidas"
5. Ver toast de √©xito
6. Radar chart actualiza

**Casos a testear**:
- Solo 1 medida ‚Üí v√°lido
- Todas las medidas ‚Üí v√°lido
- Ninguna medida ‚Üí error (al menos 1)
- Valores fuera de rango ‚Üí error

---

### 3. Upload de Foto

**Pasos**:
1. Click "Subir Foto"
2. Tab "Foto" activo
3. Click input file
4. Seleccionar imagen
5. Ver preview
6. A√±adir notas opcionales
7. Click "Subir Foto"
8. Ver toast de √©xito
9. Foto aparece en galer√≠a

**Validaciones a testear**:
- Archivo > 5MB ‚Üí error "M√°ximo 5MB"
- No imagen (PDF, TXT) ‚Üí error "Solo im√°genes"
- Submit sin archivo ‚Üí error "Selecciona imagen"

---

### 4. Comparador de Fotos

**Pasos**:
1. Tener al menos 2 fotos
2. Click "Comparar"
3. Modo compare activa
4. Click foto 1 del grid ‚Üí slot 1 (purple border)
5. Click foto 2 del grid ‚Üí slot 2 (green border)
6. Ver fotos side-by-side
7. Click X en slot ‚Üí limpia selecci√≥n
8. Click "Cancelar" ‚Üí vuelve a galer√≠a

---

### 5. Eliminar Foto

**Pasos**:
1. Click en foto de galer√≠a
2. Dialog full screen abre
3. Ver fecha y notas
4. Click "Eliminar"
5. Confirmar en alert
6. Ver toast de √©xito
7. Foto desaparece de galer√≠a

---

### 6. Responsive

**Mobile** (< 768px):
- Summary cards: 1-2 columnas
- Chart: full width, scroll horizontal si needed
- Measurements + Photos: 1 columna (stack)
- Photo grid: 2 columnas
- Forms: full width

**Tablet** (768px - 1024px):
- Summary cards: 4 columnas
- Measurements + Photos: 2 columnas
- Photo grid: 4 columnas

**Desktop** (> 1024px):
- Todo en grid
- M√°xima informaci√≥n visible
- Photo grid: 4 columnas

---

## üö® Troubleshooting

### Gr√°fico no muestra datos

**Causa**: Array vac√≠o o datos mal formateados

**Soluci√≥n**:
```typescript
// Verificar formato de data
const chartData = data.map((entry) => ({
  date: format(entry.date, 'dd MMM', { locale: es }),
  weight: entry.weight, // debe ser number
  bodyFat: entry.bodyFat,
  muscleMass: entry.muscleMass,
}));
```

### Radar chart vac√≠o

**Causa**: Todas las medidas son null

**Soluci√≥n**:
```typescript
const measurements = [
  { name: 'Pecho', current: data.chest },
  // ...
].filter((m) => m.current !== null); // Filtra nulls

if (measurements.length === 0) {
  return <EmptyState />;
}
```

### Foto no sube

**Causa**: Falta conversi√≥n a data URL

**Soluci√≥n**:
```typescript
const reader = new FileReader();
reader.onloadend = async () => {
  const dataUrl = reader.result as string;
  await saveProgressPhoto(dataUrl, notes);
};
reader.readAsDataURL(selectedFile);
```

### Form no valida

**Causa**: Schema de Zod no coincide con tipos

**Soluci√≥n**:
```typescript
// En schema: optional().or(z.literal(undefined))
bodyFat: z.number().min(3).max(60).optional().or(z.literal(undefined)),

// En register: valueAsNumber
{...registerWeight('bodyFat', { valueAsNumber: true })}
```

### Toast no se muestra

**Causa**: Falta `<Toaster />`

**Soluci√≥n**:
```tsx
import { Toaster } from 'sonner';

<Toaster position="top-right" richColors />
```

---

## üéØ Pr√≥ximas Mejoras

1. **Supabase Storage**: Upload real de fotos a bucket
2. **Comparaci√≥n Hist√≥rica**: Overlay de fotos (slider antes/despu√©s)
3. **Export**: Descargar datos en CSV o PDF
4. **Goals**: Establecer metas de peso/grasa
5. **Recordatorios**: Notificaciones para medir semanalmente
6. **Body Fat Calculator**: Calcular grasa con f√≥rmulas (Navy, etc)
7. **BMI y otras m√©tricas**: Calcular IMC, BMR, TDEE
8. **Charts avanzados**: Correlaciones peso-grasa, proyecciones
9. **Photo Filters**: Filtros de fecha, tags
10. **Multi-Photo Compare**: Comparar 3-4 fotos en grid

---

## üìö Recursos

- [Recharts Docs](https://recharts.org/)
- [react-hook-form Docs](https://react-hook-form.com/)
- [Zod Validation](https://zod.dev/)
- [sonner (Toast)](https://sonner.emilkowal.ski/)
- [Framer Motion](https://www.framer.com/motion/)
- [shadcn/ui Components](https://ui.shadcn.com/)

---

**¬°Sistema de M√©tricas Completado!** üéâ

Visita `http://localhost:3000/metrics` para registrar tu peso, medidas y fotos de progreso.

## üîë Tecnolog√≠as Principales

- **Next.js 14** - App Router, Server Actions
- **Recharts** - LineChart, RadarChart
- **react-hook-form** - Form management
- **Zod** - Schema validation
- **Prisma** - ORM para Supabase
- **sonner** - Toast notifications
- **Framer Motion** - Animations
- **shadcn/ui** - Dialog, Tabs, Input, etc
- **Tailwind CSS** - Utility-first styling

---

## üìñ Flujo Completo - Registro de Peso

```
Usuario abre forms
        ‚Üì
Tab "Peso" activo
        ‚Üì
Ingresa datos (react-hook-form)
        ‚Üì
Submit ‚Üí validaci√≥n Zod
        ‚Üì
Si v√°lido ‚Üí saveBodyWeight() Server Action
        ‚Üì
Prisma create en bodyMetric
        ‚Üì
Revalidar rutas (/metrics, /progress-new)
        ‚Üì
Toast de √©xito
        ‚Üì
Router refresh
        ‚Üì
loadData() recarga todo
        ‚Üì
Gr√°fico actualiza con nuevo punto
```

## üìñ Flujo Completo - Upload Foto

```
Usuario selecciona archivo
        ‚Üì
Validar tama√±o y tipo
        ‚Üì
FileReader crea preview (data URL)
        ‚Üì
Mostrar preview en dialog
        ‚Üì
Usuario a√±ade notas opcionales
        ‚Üì
Click "Subir Foto"
        ‚Üì
FileReader convierte a data URL
        ‚Üì
saveProgressPhoto() Server Action
        ‚Üì
Prisma create en progressPhoto
        ‚Üì
Revalidar /metrics
        ‚Üì
Toast de √©xito
        ‚Üì
Router refresh
        ‚Üì
Foto aparece en galer√≠a
```
